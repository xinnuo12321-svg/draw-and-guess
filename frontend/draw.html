<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI ä½ ç”»æˆ‘çŒœå‘ç‰Œå™¨</title>
    <style>
        body { margin: 0; padding: 0; font-family: 'PingFang SC', sans-serif; background-color: #fcd53f; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; position: relative; }
        .back-home { position: absolute; top: 20px; left: 20px; color: #333; text-decoration: none; font-weight: bold; background: white; padding: 8px 15px; border-radius: 20px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .card { background: white; width: 300px; height: 400px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.15); display: flex; flex-direction: column; align-items: center; justify-content: center; position: relative; }
        .category { background: #ff4757; color: white; padding: 5px 15px; border-radius: 20px; font-size: 14px; position: absolute; top: 20px; }
        .word { font-size: 48px; font-weight: 900; color: #333; margin: 20px 0; }
        .timer { font-size: 30px; color: #2e86de; font-family: monospace; }
        .btn { margin-top: 30px; background: #2e86de; color: white; border: none; padding: 15px 40px; font-size: 18px; border-radius: 30px; font-weight: bold; cursor: pointer; box-shadow: 0 5px 15px rgba(46, 134, 222, 0.4); }
        .btn:active { transform: scale(0.95); }
    </style>
</head>
<body>
    <a href="/index.html" class="back-home">â¬… è¿”å›å¤§å…</a>

    <div class="card">
        <div class="category" id="category">å‡†å¤‡å°±ç»ª</div>
        <div class="word" id="word">ç‚¹ä¸‹å‘ç‰Œ</div>
        <div class="timer" id="timer">60s</div>
    </div>

    <button class="btn" onclick="drawCard()">ğŸƒ æŠ½å–é¢˜ç›®</button>

    <script>
        let countdown;
        
        async function drawCard() {
            document.getElementById('word').innerText = "åŠ è½½ä¸­...";
            document.getElementById('category').innerText = "è¯·æ±‚ä¸­";
            clearInterval(countdown);
            document.getElementById('timer').innerText = "60s";

            try {
                // æ ¸å¿ƒå…³é”®ï¼šæ ‡å‡†çš„ç›¸å¯¹è·¯å¾„
                const response = await fetch('/api/draw_card');
                const data = await response.json();
                
                if (data.status === "success") {
                    document.getElementById('word').innerText = data.word;
                    document.getElementById('category').innerText = data.category;
                    startTimer();
                } else {
                    document.getElementById('word').innerText = "å‘ç‰Œå¤±è´¥";
                    // æ‰“å°å‡ºåç«¯åˆ°åº•æŠ¥äº†ä»€ä¹ˆé”™
                    document.getElementById('category').innerText = data.message.substring(0, 10);
                }
            } catch (error) {
                // å¦‚æœæ˜¯è¿™é‡ŒæŠ¥é”™ï¼Œè¯´æ˜å‰ç«¯å‹æ ¹æ²¡è¿ä¸Šåç«¯
                document.getElementById('word').innerText = "ç½‘ç»œæ–­å¼€";
                document.getElementById('category').innerText = "è¯·æ£€æŸ¥åç«¯";
                console.error("Fetch Error:", error);
            }
        }

        function startTimer() {
            let timeLeft = 60;
            document.getElementById('timer').innerText = timeLeft + "s";
            countdown = setInterval(() => {
                timeLeft--;
                document.getElementById('timer').innerText = timeLeft + "s";
                if (timeLeft <= 0) clearInterval(countdown);
            }, 1000);
        }
    </script>
</body>
</html>